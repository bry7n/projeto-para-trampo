<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Login F.U.B</title>
    <link rel="stylesheet" href="./src/login.css" />
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  </head>
  <body>
    <div class="container">
      <form>
        <h1>Acesse a sua conta</h1>

        <input type="email" id="email" placeholder="Digite seu e-mail" />
        <input type="password" id="senha" placeholder="Digite sua senha" />
        <button onclick="logar()">Entrar</button>

        <p id="mensagem"></p>
        <p id="loading" style="display: none">Carregando...</p>
      </form>
    </div>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyBRAyqFg4WNWzz5E1LYuXkB0InO_DzwBWk",
        authDomain: "login-9396e.firebaseapp.com",
        projectId: "login-9396e",
        storageBucket: "login-9396e.firebasestorage.app",
        messagingSenderId: "416311430302",
        appId: "1:416311430302:web:83e745f575aa6577f67f8f",
        measurementId: "G-542RPDS93Y",
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();

      function logar() {
        const email = document.getElementById("email").value;
        const senha = document.getElementById("senha").value;

        if (!email || !senha) {
          document.getElementById("mensagem").innerText =
            "Por favor, preencha todos os campos.";
          return;
        }

        const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
        if (!emailRegex.test(email)) {
          document.getElementById("mensagem").innerText =
            "Digite um E-mail válido.";
          return;
        }

        document.getElementById("loading").style.display = "block";

        auth
          .signInWithEmailAndPassword(email, senha)
          .then((userCredential) => {
            window.location.href = "index.html";
          })
          .catch((error) => {
            let mensagem = "Usuário e/ou senha incorretos.";

            if (error.code === "auth/invalid-email") {
              mensagem = "Digite um E-mail válido.";
            } else if (error.code === "auth/user-not-found") {
              mensagem = "Usuário não encontrado.";
            } else if (error.code === "auth/wrong-password") {
              mensagem = "Senha incorreta.";
            } else if (error.code === "auth/missing-password") {
              mensagem = "Digite a senha.";
            }

            document.getElementById("mensagem").innerText = mensagem;
          })
          .finally(() => {
            document.getElementById("loading").style.display = "none";
          });
      }
    </script>
  </body>
</html>
